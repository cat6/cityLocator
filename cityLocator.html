<!DOCTYPE html>
<html>

<head>
    <title>City Locator</title>
    <meta charset="UTF-8">
</head>

<body>

<h3>City Locator</h3>

<form>
    City Name: <input type="text" name="cityInput" id="cityInput"><br/>
    <button type="button" onclick="getCityData(this.form)">Check</button>
</form>

<div id="geography"></div>

<script>

function getCityData(frm)
{
    var cityXML = new XMLHttpRequest();
    var cityURL1 = "http://maps.googleapis.com/maps/api/geocode/json?address=";
    var cityName = frm.cityInput.value;
    var cityURL2 = "&sensor=false";
    var cityURL = cityURL1 + cityName + cityURL2;

    frm.cityInput.value = "";

    cityXML.onreadystatechange=function() 
    {
        if (cityXML.readyState == 4 && cityXML.status == 200) 
        {
            parseCity(cityXML.responseText);
        }
    }

    cityXML.open("GET", cityURL, true);
    cityXML.send();
}

function parseCity(response) 
{
    var jsonArr = JSON.parse(response)
    var i;
    var output = "";

    // Foreach over every response and report
    for(i = 0; i < jsonArr.results.length; i++)
    {
        output += "<b>City: </b>" + jsonArr.results[i].address_components[0].long_name + "<br/>";
        if(jsonArr.results[i].address_components.long_name)
        {
            output += "<b>Country: </b>" + jsonArr.results[i].address_components.pop().long_name + "<br/>";
        }
        if(jsonArr.results[i].address_components[2].long_name)
        {
            output += "<b>State/Province:</b> " + jsonArr.results[i].address_components[2].long_name + "<br/>";
        }

        output += "<b>Co-ordinates: </b><br/>" + jsonArr.results[i].geometry.location.lat + " <b>latitude <br/>by<br/></b> " + jsonArr.results[i].geometry.location.lng + " <b>longitude</b><br/><br/>";
    }
    output += "<b>Number of cities with this name found:</b> " + jsonArr.results.length + "<br/>";
    document.getElementById("geography").innerHTML = output;
}
</script>

</body>
</html>
